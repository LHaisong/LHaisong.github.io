layout:     post
title:      mysql日志文件
subtitle:   日志文件
date:       2019-08-10
author:     LHaisong
header-img: img/post-bg-re-vs-ng2.jpg
catalog: true
tags:
    - 数据库
## MySQL的中的日志  

- 错误日志：对MySQL的启动、运行、关闭过程进行记录，可通过错误日志定位MySQL存在的问题  

- 慢查询日志：定位存在问题的SQL语句，从而进行SQL语句层面的优化，在默认的情况下MySQL数据库并不启动慢查询日志，需要手动开启。  

- 查询日志：记录了所有对MySQL的请求信息。 

- 二进制日志：记录了对MySQL数据库执行更改的所有操作，但是不包括show和select这类没有对数据库进行修改的操作。  
  作用：1)恢复 2)复制 3)审计    

- 重做日志(redo)：重做日志文件用于实现事务的持久性。由两部分组成：  

  1. 是内存中的重做日志缓冲，是易失的  
  2. 是重做日志文件，是持久的，事务提交时必须将事务的日志全部写入重做日志文件进行持久化，待事务的commit操作完成才算完成，但是在数据库中也允许非持久化的操作，为了提高数据库的性能，可每隔一段时间才进行一次将事务日志从日志缓存中写入重做日志  
  3. 事务提交时的操作：  
     ①修改内存中对应的事务信息，并且将日志写入重做日志缓冲  
     ②调用fsync将确保日志都被从重做日志缓冲写入磁盘  

  > 二进制日志和重做日志的区别：二进制日志主要用来进行pointtotime的恢复及主从复制环境的建立，它在数据库的上层产生，是一种逻辑日志，对应的是SQL语句，它不只针对InnoDB存储引擎，数据库中的任何引擎对数据库的修改都会产生二进制日志，在事务提交完成后对它进行一次修改。重做日志在InnoDB存储引擎层产生，它是一种物理格式日志，记录的是对每个页的修改。  

- undo日志：用来帮助事务进行回滚和MVCC功能，当执行rollback语句时可利用undo信息将数据回滚到修改前的样子(并不是事务开始前的样子) 

- purge：用于完成delete和update的最终操作，当执行一条delete语句时，记录并不会直接被删除，而只是将delete flag标记为1，标记已删除，最终的删除任务由purge完成  
